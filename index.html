<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyber Mines Pro</title>
    <style>
        /* --- CORE SETTINGS --- */
        body {
            margin: 0; padding: 0;
            background-color: #020205; 
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; justify-content: center; align-items: center;
        }

        .game-wrapper {
            position: relative;
            width: 100%; height: 100%; max-width: 480px;
            background-image: url('assets/bg_mines.jpg'); 
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; justify-content: space-between;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.15);
            overflow: hidden;
        }

        /* --- HEADER --- */
        .header {
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            border-bottom: 1px solid rgba(0, 255, 204, 0.3);
            z-index: 10;
        }
        .logo { font-weight: 900; font-size: 20px; color: #fff; text-shadow: 0 0 10px #00ffcc; }
        .balance-box {
            background: rgba(0, 20, 20, 0.9); border: 1px solid #00ffcc; color: #00ffcc;
            padding: 6px 15px; border-radius: 4px; font-weight: bold; font-family: monospace;
        }

        /* --- GRID AREA --- */
        .grid-container {
            flex-grow: 1;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 20px; position: relative;
        }

        .mines-grid {
            display: grid; grid-template-columns: repeat(5, 1fr);
            gap: 8px; width: 100%; max-width: 360px;
            perspective: 1000px; /* 3D Space */
        }

        /* --- NEW TILE SYSTEM (Front/Back) --- */
        .tile {
            aspect-ratio: 1/1;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d; /* Zaroori hai flip ke liye */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Uchalne wala effect */
        .tile:hover { transform: translateY(-5px); }
        .tile:active { transform: scale(0.95); }

        /* Jab tile khulegi */
        .tile.revealed {
            transform: rotateY(180deg);
            cursor: default;
        }

        /* Front aur Back Faces */
        .tile-face {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden; /* Peeche wala hissa chupana */
            border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            font-size: 30px; /* Emoji size */
            box-shadow: 0 4px 6px rgba(0,0,0,0.5);
        }

        /* FRONT (Band Dabba) */
        .front {
            background-color: #1a1a1a;
            background-image: url('assets/tile_closed.png');
            background-size: 100% 100%;
            border: 1px solid #333;
            /* Pulse Animation */
            animation: neon-pulse 3s infinite ease-in-out;
        }

        /* BACK (Khula Dabba) */
        .back {
            transform: rotateY(180deg); /* Pehle se ulta rakho */
            background-color: #081015;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.9);
            border: 2px solid transparent;
        }

        /* --- GEM STYLE --- */
        .tile.gem .back {
            background-color: rgba(0, 255, 204, 0.1); /* Fallback color */
            border-color: #00ffcc;
            box-shadow: 0 0 20px #00ffcc;
        }
        /* Asal Image */
        .tile.gem .back-icon {
            width: 80%; height: 80%;
            background-image: url('assets/tile_diamond.png');
            background-size: contain; background-repeat: no-repeat; background-position: center;
            filter: drop-shadow(0 0 10px #00ffcc);
            animation: pop-in 0.4s ease-out;
        }

        /* --- BOMB STYLE --- */
        .tile.bomb .back {
            background-color: rgba(255, 0, 68, 0.2); /* Fallback color */
            border-color: #ff0044;
            box-shadow: 0 0 30px #ff0044;
        }
        .tile.bomb .back-icon {
            width: 85%; height: 85%;
            background-image: url('assets/tile_bomb.png');
            background-size: contain; background-repeat: no-repeat; background-position: center;
            filter: drop-shadow(0 0 10px #ff0044);
            animation: shake-icon 0.4s ease-in-out;
        }

        /* --- ANIMATIONS --- */
        @keyframes neon-pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(0, 255, 204, 0.1); border-color: #333; }
            50% { box-shadow: 0 0 15px rgba(0, 255, 204, 0.4); border-color: #00ffcc; }
        }
        @keyframes pop-in { 0% { transform: scale(0); } 80% { transform: scale(1.2); } 100% { transform: scale(1); } }
        @keyframes shake-icon { 0% { transform: translate(0,0); } 25% { transform: translate(-5px, 5px); } 75% { transform: translate(5px, -5px); } 100% { transform: translate(0,0); } }
        
        @keyframes shake-screen {
            0%, 100% { transform: translate(0,0); }
            25% { transform: translate(-10px, 10px); }
            50% { transform: translate(10px, -10px); }
            75% { transform: translate(-10px, -10px); }
        }
        .game-wrapper.shake-all { animation: shake-screen 0.5s; border: 2px solid red; }

        /* --- CONTROLS --- */
        .controls-panel {
            background: rgba(15, 20, 25, 0.95); padding: 20px;
            border-top: 1px solid #333; display: flex; flex-direction: column; gap: 12px; z-index: 20;
        }
        .bet-row { display: flex; justify-content: space-between; gap: 10px; }
        .input-group { flex: 1; display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 11px; color: #888; text-transform: uppercase; }
        input, select {
            background: #222; border: 1px solid #444; color: white; padding: 12px;
            border-radius: 6px; font-weight: bold; font-size: 16px; outline: none; text-align: center;
        }
        .action-btn {
            background: #00ffcc; border: none; color: #000; padding: 16px;
            border-radius: 6px; font-size: 18px; font-weight: 900; text-transform: uppercase;
            cursor: pointer; box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
        }
        .cashout-btn { background: #ffcc00; display: none; box-shadow: 0 0 20px rgba(255, 204, 0, 0.4); }

        /* Message Overlay */
        .msg-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: rgba(0,0,0,0.9); padding: 20px 40px; border-radius: 10px; 
            border: 2px solid; text-align: center; z-index: 100; transition: transform 0.3s;
        }
        .msg-overlay.show { transform: translate(-50%, -50%) scale(1); }
        .msg-title { font-size: 30px; font-weight: 900; margin-bottom: 5px; }

    </style>
</head>
<body>

    <div class="game-wrapper" id="gameWrapper">
        
        <div id="msgBox" class="msg-overlay">
            <div class="msg-title" id="msgTitle"></div>
            <div id="msgText"></div>
        </div>

        <div class="header">
            <div class="logo">MINES</div>
            <div class="balance-box">PKR <span id="balance">5,000</span></div>
        </div>

        <div class="grid-container">
            <div style="margin-bottom:10px; color:#aaa; font-size:14px;">Next Profit: <span id="nextProfit" style="color:#00ffcc; font-weight:bold;">0</span></div>
            <div class="mines-grid" id="grid"></div>
        </div>

        <div class="controls-panel">
            <div class="bet-row">
                <div class="input-group">
                    <label>Bet</label>
                    <input type="number" value="100" id="betAmount">
                </div>
                <div class="input-group">
                    <label>Mines</label>
                    <select id="minesCount">
                        <option value="1">1</option>
                        <option value="3" selected>3</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                    </select>
                </div>
            </div>
            <button class="action-btn" id="startBtn" onclick="startGame()">BET</button>
            <button class="action-btn cashout-btn" id="cashoutBtn" onclick="cashout()">CASHOUT</button>
        </div>

    </div>

    <script>
        // --- GAME LOGIC ---
        let balance = 5000;
        let active = false;
        let mines = [];
        let revealed = 0;
        let bet = 0;
        let multiplier = 1.0;
        const totalTiles = 25;

        const grid = document.getElementById('grid');
        const balanceEl = document.getElementById('balance');
        const msgBox = document.getElementById('msgBox');
        
        // 1. Grid Banana
        function createGrid() {
            grid.innerHTML = '';
            for(let i=0; i<totalTiles; i++) {
                // Naya HTML Structure (Front + Back)
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.dataset.id = i;
                tile.onclick = () => clickTile(i);
                
                // Front (Band) aur Back (Khula) divs
                tile.innerHTML = `
                    <div class="tile-face front"></div>
                    <div class="tile-face back">
                        <div class="back-icon"></div> </div>
                `;
                grid.appendChild(tile);
            }
        }

        function startGame() {
            bet = parseFloat(document.getElementById('betAmount').value);
            const minesCount = parseInt(document.getElementById('minesCount').value);
            
            if(bet > balance) { alert("Balance low!"); return; }
            
            // State Reset
            active = true;
            revealed = 0;
            multiplier = 1.0;
            balance -= bet;
            updateBalance();
            
            // Random Mines Logic
            mines = [];
            while(mines.length < minesCount) {
                let r = Math.floor(Math.random() * 25);
                if(!mines.includes(r)) mines.push(r);
            }

            // UI Reset
            createGrid(); // Grid refresh
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('cashoutBtn').style.display = 'block';
            msgBox.classList.remove('show');
            updateProfitUI();
        }

        function clickTile(index) {
            if(!active) return;
            const tile = grid.children[index];
            if(tile.classList.contains('revealed')) return;

            // Flip Animation
            tile.classList.add('revealed');
            
            // Check Bomb or Gem
            const backFace = tile.querySelector('.back');
            const icon = tile.querySelector('.back-icon');

            if(mines.includes(index)) {
                // --- BOMB (Loss) ---
                tile.classList.add('bomb');
                // Agar image nahi mili to ye emoji dikhega (Fallback)
                if(getComputedStyle(icon).backgroundImage === 'none') icon.innerHTML = 'ðŸ’£';
                
                gameOver(false);
            } else {
                // --- GEM (Win) ---
                tile.classList.add('gem');
                // Fallback Emoji
                if(getComputedStyle(icon).backgroundImage === 'none') icon.innerHTML = 'ðŸ’Ž';
                
                revealed++;
                calculateMultiplier();
                
                if(revealed === (25 - mines.length)) cashout(); // Auto Win
            }
        }

        function calculateMultiplier() {
            // Simple multiplier logic
            multiplier *= 1.15; // Har gem par 15% increase
            updateProfitUI();
        }

        function updateProfitUI() {
            const currentWin = Math.floor(bet * multiplier);
            document.getElementById('cashoutBtn').innerText = `CASHOUT ${currentWin}`;
            document.getElementById('nextProfit').innerText = Math.floor(bet * (multiplier * 1.15));
        }

        function cashout() {
            if(!active) return;
            const win = Math.floor(bet * multiplier);
            balance += win;
            updateBalance();
            gameOver(true, win);
        }

        function gameOver(win, amount) {
            active = false;
            
            // Reveal all mines
            mines.forEach(idx => {
                const t = grid.children[idx];
                t.classList.add('revealed', 'bomb');
            });

            // Effect
            if(!win) {
                document.getElementById('gameWrapper').classList.add('shake-all');
                setTimeout(()=> document.getElementById('gameWrapper').classList.remove('shake-all'), 500);
            }

            // Message
            msgBox.classList.add('show');
            msgBox.style.borderColor = win ? '#00ffcc' : '#ff0044';
            document.getElementById('msgTitle').innerText = win ? "YOU WON!" : "BOOM!";
            document.getElementById('msgTitle').style.color = win ? '#00ffcc' : '#ff0044';
            document.getElementById('msgText').innerText = win ? `+${amount}` : "Try Again";

            // Buttons Reset
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('cashoutBtn').style.display = 'none';
        }

        function updateBalance() {
            balanceEl.innerText = balance.toLocaleString();
        }

        // Init
        createGrid();

    </script>
</body>
</html>

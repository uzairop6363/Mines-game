<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyber Mines - Hacker Edition</title>
    <style>
        /* --- 1. CORE & LOADING SCREEN --- */
        body {
            margin: 0; padding: 0;
            background-color: #000;
            font-family: 'Courier New', monospace; /* Hacker Font */
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; flex-direction: column; align-items: center;
            user-select: none; -webkit-user-select: none;
        }

        /* Loading Screen Overlay */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            background-image: url('assets/poster_mines.jpg'); /* YOUR POSTER */
            background-size: cover; background-position: center;
            z-index: 9999;
            display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
            padding-bottom: 80px;
            transition: opacity 0.8s ease-out;
        }

        .loading-text {
            color: #0f0; /* Hacker Green */
            font-size: 18px; font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #0f0;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* Loading Bar Frame */
        .progress-container {
            width: 80%; max-width: 320px; height: 35px;
            background-image: url('assets/frame_mines.png'); /* YOUR FRAME */
            background-size: 100% 100%; background-repeat: no-repeat;
            display: flex; align-items: center; padding: 0 6px;
            box-sizing: border-box;
            filter: drop-shadow(0 0 15px #00ff00);
        }

        /* Loading Fill (Cyber Blue/Green) */
        .progress-fill {
            height: 50%; width: 0%;
            background: linear-gradient(90deg, #00ff00, #00ffff, #00ff00);
            background-size: 200% 100%;
            border-radius: 2px;
            box-shadow: 0 0 10px #00ff00;
            transition: width 0.2s ease-out;
            animation: cyberFlow 1s linear infinite;
        }
        @keyframes cyberFlow { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }

        /* --- 2. GAME INTERFACE (Hidden Initially) --- */
        .game-wrapper {
            position: relative; width: 100%; height: 100%;
            max-width: 500px;
            background: radial-gradient(circle at center, #001a00 0%, #000 90%); /* Dark Hacker BG */
            display: flex; flex-direction: column; align-items: center;
            opacity: 0; transition: opacity 1s ease-in;
        }
        .game-wrapper.active { opacity: 1; }

        /* Grid Background Effect (Matrix Lines) */
        .game-wrapper::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(0, 255, 0, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 255, 0, 0.03) 1px, transparent 1px);
            background-size: 20px 20px; pointer-events: none; z-index: 0;
        }

        /* Header */
        .header {
            margin-top: 30px; text-align: center; z-index: 10;
            width: 100%;
        }
        .cyber-title {
            font-size: 40px; font-weight: 900; color: #fff;
            text-transform: uppercase; letter-spacing: 3px;
            text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00;
        }

        /* --- 3. MINES GRID --- */
        .mines-container {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            padding: 15px;
            background: rgba(0, 20, 0, 0.6);
            border: 1px solid #00ff00;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            z-index: 10;
        }

        .tile {
            width: 60px; height: 60px;
            background: rgba(0, 50, 0, 0.5);
            border: 1px solid #004400;
            border-radius: 8px;
            cursor: pointer;
            display: flex; justify-content: center; align-items: center;
            transition: all 0.2s;
            position: relative; overflow: hidden;
        }
        .tile:active { transform: scale(0.95); }
        .tile.revealed { background: #002200; border-color: #00ff00; }
        .tile.lost { background: #330000; border-color: red; }

        .tile-icon {
            width: 70%; height: 70%;
            background-size: contain; background-repeat: no-repeat; background-position: center;
            transform: scale(0); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .tile.revealed .tile-icon { transform: scale(1); }

        /* --- 4. CONTROLS --- */
        .controls-panel {
            margin-top: auto; margin-bottom: 20px;
            width: 90%;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff00;
            padding: 15px; border-radius: 15px;
            display: flex; flex-direction: column; gap: 15px;
            z-index: 10;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.1);
        }

        .info-row { display: flex; justify-content: space-between; align-items: center; color: #00ff00; font-size: 14px; }
        .balance-display { font-size: 20px; font-weight: bold; text-shadow: 0 0 5px #00ff00; }

        .bet-controls { display: flex; gap: 10px; align-items: center; }
        .input-box {
            flex: 1; background: #001100; border: 1px solid #005500;
            color: #fff; padding: 10px; text-align: center; font-family: monospace; font-size: 18px;
            border-radius: 5px;
        }

        .action-btn {
            width: 100%; padding: 15px;
            background: linear-gradient(90deg, #004400, #008800);
            border: 1px solid #00ff00; color: #fff;
            font-family: monospace; font-size: 20px; font-weight: bold;
            cursor: pointer; text-transform: uppercase;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
            transition: all 0.2s;
        }
        .action-btn:active { transform: scale(0.98); }
        .action-btn.cashout { background: linear-gradient(90deg, #b8860b, #ffd700); border-color: gold; color: #000; box-shadow: 0 0 15px gold; }
        .action-btn:disabled { filter: grayscale(1); cursor: not-allowed; }

        /* Mine Selector */
        .mines-select {
            display: flex; justify-content: space-between; margin-bottom: 10px;
        }
        .mine-opt {
            background: #002200; border: 1px solid #005500; color: #00aa00;
            padding: 5px 10px; cursor: pointer; border-radius: 4px;
        }
        .mine-opt.active { background: #00ff00; color: #000; box-shadow: 0 0 10px #00ff00; }

        /* Message Overlay */
        .msg-overlay {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: rgba(0,0,0,0.9); border: 2px solid #00ff00;
            padding: 20px 40px; text-align: center;
            z-index: 50; pointer-events: none; transition: transform 0.3s;
        }
        .msg-text { color: #fff; font-size: 24px; margin-bottom: 5px; }
        .msg-sub { color: #00ff00; font-size: 30px; font-weight: bold; }

    </style>
</head>
<body>

    <div id="loader">
        <div class="loading-text" id="loadStatus">INITIALIZING SYSTEM...</div>
        <div class="progress-container">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>

    <div class="game-wrapper" id="gameScreen">
        
        <div class="header">
            <div class="cyber-title">CYBER MINES</div>
        </div>

        <div class="mines-container" id="grid">
            </div>

        <div class="msg-overlay" id="msgBox">
            <div class="msg-text" id="msgTitle">SYSTEM HACKED</div>
            <div class="msg-sub" id="msgAmount">+500</div>
        </div>

        <div class="controls-panel">
            <div class="info-row">
                <span>BALANCE</span>
                <span class="balance-display">PKR <span id="balance">50000</span></span>
            </div>

            <div style="color:#00ff00; font-size:12px; margin-bottom:5px;">MINES DENSITY:</div>
            <div class="mines-select">
                <div class="mine-opt active" onclick="setMines(1)">1</div>
                <div class="mine-opt" onclick="setMines(3)">3</div>
                <div class="mine-opt" onclick="setMines(5)">5</div>
                <div class="mine-opt" onclick="setMines(10)">10</div>
                <div class="mine-opt" onclick="setMines(20)">20</div>
            </div>

            <div class="bet-controls">
                <input type="number" class="input-box" id="betAmount" value="100">
            </div>

            <button class="action-btn" id="mainBtn" onclick="startGame()">START HACK</button>
        </div>

    </div>

    <script>
        // --- LOADING LOGIC ---
        window.onload = function() {
            const bar = document.getElementById('progressBar');
            const loader = document.getElementById('loader');
            const status = document.getElementById('loadStatus');
            const game = document.getElementById('gameScreen');
            let width = 0;

            const simulateLoading = () => {
                let jump = Math.floor(Math.random() * 15) + 1; 
                if(Math.random() > 0.7) jump = 0; // Random pause

                width += jump;
                if(width > 100) width = 100;

                bar.style.width = width + '%';

                // Hacker Style Status Updates
                if(width < 30) status.innerText = "BYPASSING FIREWALL...";
                else if(width < 60) status.innerText = "INJECTING SCRIPTS...";
                else if(width < 90) status.innerText = "DECRYPTING ASSETS...";
                else status.innerText = "ACCESS GRANTED";

                if (width >= 100) {
                    setTimeout(() => {
                        loader.style.opacity = '0';
                        setTimeout(() => {
                            loader.style.display = 'none';
                            game.classList.add('active');
                        }, 800);
                    }, 500);
                } else {
                    setTimeout(simulateLoading, Math.random() * 150 + 50);
                }
            };
            simulateLoading();
            createGrid(); // Prepare Grid behind scenes
        };

        // --- GAME LOGIC ---
        let balance = 50000;
        let isPlaying = false;
        let mineCount = 1;
        let minesLocation = [];
        let tilesClicked = 0;
        let currentBet = 0;
        let currentMultiplier = 1.0;

        // Assets
        const diamondImg = 'url("assets/icon_diamond.png")';
        const bombImg = 'url("assets/icon_bomb.png")';

        function createGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.id = `tile-${i}`;
                tile.onclick = () => clickTile(i);
                
                const icon = document.createElement('div');
                icon.className = 'tile-icon';
                icon.id = `icon-${i}`;
                
                tile.appendChild(icon);
                grid.appendChild(tile);
            }
        }

        function setMines(num) {
            if(isPlaying) return;
            mineCount = num;
            document.querySelectorAll('.mine-opt').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
        }

        function startGame() {
            if(isPlaying) {
                cashOut();
                return;
            }

            const betInput = document.getElementById('betAmount');
            const bet = parseInt(betInput.value);

            if(bet > balance) { alert("INSUFFICIENT FUNDS"); return; }
            if(bet < 10) { alert("MIN BET 10"); return; }

            // Deduct Balance
            balance -= bet;
            currentBet = bet;
            updateBalance();

            // Reset Game State
            isPlaying = true;
            tilesClicked = 0;
            currentMultiplier = 1.0;
            minesLocation = generateMines();
            
            // Reset UI
            document.querySelectorAll('.tile').forEach(t => {
                t.className = 'tile';
                t.querySelector('.tile-icon').style.backgroundImage = 'none';
            });
            document.getElementById('msgBox').style.transform = "translate(-50%, -50%) scale(0)";

            // Change Button to Cashout
            const btn = document.getElementById('mainBtn');
            btn.innerText = "CASHOUT: " + bet;
            btn.classList.add('cashout');
        }

        function generateMines() {
            let locs = [];
            while(locs.length < mineCount) {
                let r = Math.floor(Math.random() * 25);
                if(!locs.includes(r)) locs.push(r);
            }
            return locs;
        }

        function clickTile(index) {
            if(!isPlaying) return;
            const tile = document.getElementById(`tile-${index}`);
            if(tile.classList.contains('revealed')) return;

            tile.classList.add('revealed');

            if(minesLocation.includes(index)) {
                // GAME OVER (BOMB)
                gameOver(index);
            } else {
                // DIAMOND FOUND
                const icon = document.getElementById(`icon-${index}`);
                icon.style.backgroundImage = diamondImg;
                
                tilesClicked++;
                calculateMultiplier();
            }
        }

        function calculateMultiplier() {
            // Simple multiplier logic (Increases as you click more)
            // Logic: 1.0 + (tiles * mines * 0.05) - Simplified
            let growth = 0.1 * mineCount; 
            currentMultiplier += growth; 
            
            let winVal = Math.floor(currentBet * currentMultiplier);
            document.getElementById('mainBtn').innerText = "CASHOUT: " + winVal;
        }

        function cashOut() {
            if(!isPlaying) return;
            
            let winVal = Math.floor(currentBet * currentMultiplier);
            balance += winVal;
            updateBalance();
            
            showMessage("HACK SUCCESS", "+" + winVal, "#00ff00");
            endGame(true);
        }

        function gameOver(hitIndex) {
            // Show Hit Bomb
            document.getElementById(`icon-${hitIndex}`).style.backgroundImage = bombImg;
            document.getElementById(`tile-${hitIndex}`).classList.add('lost');

            // Reveal All Mines
            minesLocation.forEach(idx => {
                document.getElementById(`tile-${idx}`).classList.add('revealed');
                document.getElementById(`tile-${idx}`).classList.add('lost');
                document.getElementById(`icon-${idx}`).style.backgroundImage = bombImg;
            });

            showMessage("SYSTEM FAILED", "LOST SIGNAL", "red");
            endGame(false);
        }

        function endGame(won) {
            isPlaying = false;
            const btn = document.getElementById('mainBtn');
            btn.innerText = "START HACK";
            btn.classList.remove('cashout');
        }

        function showMessage(title, sub, color) {
            const box = document.getElementById('msgBox');
            document.getElementById('msgTitle').innerText = title;
            document.getElementById('msgAmount').innerText = sub;
            document.getElementById('msgAmount').style.color = color;
            box.style.transform = "translate(-50%, -50%) scale(1)";
            
            setTimeout(() => {
                if(!isPlaying) box.style.transform = "translate(-50%, -50%) scale(0)";
            }, 2000);
        }

        function updateBalance() {
            document.getElementById('balance').innerText = balance;
        }

    </script>
</body>
</html>

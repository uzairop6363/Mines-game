
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyber Mines - Pro</title>
    <style>
        /* --- 1. CORE SETTINGS --- */
        body {
            margin: 0; padding: 0;
            background-color: #000;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; flex-direction: column; align-items: center;
            user-select: none; -webkit-user-select: none;
        }

        /* --- LOADING SCREEN --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('assets/poster_mines.jpg'); 
            background-size: cover; background-position: center;
            z-index: 9999;
            display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
            padding-bottom: 80px; transition: opacity 0.8s ease-out;
        }

        .loading-text {
            color: #fff; font-size: 18px; font-weight: bold; margin-bottom: 10px;
            text-shadow: 0 2px 5px #000; letter-spacing: 2px;
        }

        .progress-container {
            width: 80%; max-width: 320px; height: 35px;
            background-image: url('assets/frame_mines.png');
            background-size: 100% 100%; background-repeat: no-repeat;
            display: flex; align-items: center; padding: 0 6px;
            box-sizing: border-box; filter: drop-shadow(0 0 10px cyan);
        }

        .progress-fill {
            height: 50%; width: 0%;
            background: linear-gradient(90deg, #00ffff, #0088ff);
            border-radius: 4px; transition: width 0.2s ease-out;
            box-shadow: 0 0 10px cyan;
        }

        /* --- 2. MAIN GAME UI --- */
        .game-wrapper {
            position: relative; width: 100%; height: 100%;
            max-width: 500px;
            /* BACKGROUND IMAGE FROM YOUR ASSETS */
            background-image: url('assets/bg_mines.jpg');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; align-items: center;
            opacity: 0; transition: opacity 1s ease-in;
        }
        .game-wrapper.active { opacity: 1; }

        /* BACK BUTTON */
        .back-btn {
            position: absolute; top: 20px; left: 20px; width: 45px; height: 45px;
            background-image: url('assets/btn_back.png');
            background-size: 100% 100%; background-color: transparent; border: none;
            cursor: pointer; z-index: 50;
        }

        /* HEADER / LOGO (Text for now, or use image if you have logo) */
        .header { margin-top: 30px; text-align: center; z-index: 10; }
        .game-title {
            font-size: 35px; font-weight: 900; color: #fff;
            text-shadow: 0 0 10px cyan, 0 0 20px blue;
            text-transform: uppercase; letter-spacing: 2px;
        }

        /* --- 3. MINES GRID --- */
        .mines-container {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            padding: 15px;
            /* Transparent background because tiles have their own images */
            z-index: 10;
        }

        .tile {
            width: 60px; height: 60px;
            /* DEFAULT CLOSED TILE IMAGE */
            background-image: url('assets/tile_closed.png');
            background-size: 100% 100%;
            border-radius: 5px; cursor: pointer;
            transition: transform 0.1s;
            position: relative;
        }
        .tile:active { transform: scale(0.95); }
        
        /* REVEALED STATES */
        .tile.diamond { background-image: url('assets/tile_diamond.png'); }
        .tile.bomb { background-image: url('assets/tile_bomb.png'); }
        .tile.dim { filter: brightness(0.4); } /* For other mines when lost */

        /* --- 4. CONTROLS PANEL (Bottom) --- */
        .controls-panel {
            margin-top: auto; width: 100%; height: 220px;
            /* CONTROLS BACKGROUND IMAGE */
            background-image: url('assets/ui_controls_bg.png');
            background-size: 100% 100%;
            display: flex; flex-direction: column; align-items: center;
            padding: 20px; box-sizing: border-box;
            z-index: 20;
        }

        /* Balance & Bet Row */
        .top-row {
            display: flex; justify-content: space-between; width: 100%;
            margin-bottom: 15px; align-items: center;
        }

        .balance-box {
            width: 140px; height: 45px;
            background-image: url('assets/ui_balance_panel.png');
            background-size: 100% 100%;
            display: flex; justify-content: center; align-items: center;
            color: #fff; font-weight: bold; font-size: 16px;
            text-shadow: 0 1px 3px #000;
        }

        .input-box {
            width: 120px; height: 45px;
            background-image: url('assets/ui_input_bg.png');
            background-size: 100% 100%; border: none;
            text-align: center; color: #fff; font-size: 18px; font-weight: bold;
            background-color: transparent; outline: none;
        }

        /* Mines Selector Buttons */
        .mines-select {
            display: flex; gap: 10px; margin-bottom: 15px;
        }
        .mine-btn {
            width: 40px; height: 40px;
            background: rgba(0,0,0,0.5); border: 1px solid cyan;
            color: cyan; font-weight: bold; border-radius: 5px;
            cursor: pointer;
        }
        .mine-btn.active { background: cyan; color: #000; box-shadow: 0 0 10px cyan; }

        /* Main Action Button */
        .action-btn {
            width: 200px; height: 60px;
            background-image: url('assets/btn_action.png');
            background-size: 100% 100%; background-color: transparent; border: none;
            color: #fff; font-size: 20px; font-weight: 900;
            text-shadow: 0 2px 4px #000; cursor: pointer;
            transition: transform 0.1s;
        }
        .action-btn:active { transform: scale(0.95); }

        /* Popup Message */
        .msg-overlay {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: rgba(0,0,0,0.9); border: 2px solid cyan; border-radius: 10px;
            padding: 20px 40px; text-align: center; z-index: 100;
            transition: transform 0.3s; pointer-events: none;
        }
        .msg-text { color: #fff; font-size: 22px; margin-bottom: 5px; }
        .msg-amount { color: cyan; font-size: 30px; font-weight: bold; }

    </style>
</head>
<body>

    <div id="loader">
        <div class="loading-text" id="loadStatus">CONNECTING...</div>
        <div class="progress-container">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>

    <div class="game-wrapper" id="gameScreen">
        
        <button class="back-btn" onclick="alert('Back')"></button>

        <div class="header">
            <div class="game-title">CYBER MINES</div>
        </div>

        <div class="mines-container" id="grid"></div>

        <div class="msg-overlay" id="msgBox">
            <div class="msg-text" id="msgTitle">WIN</div>
            <div class="msg-amount" id="msgVal">+0</div>
        </div>

        <div class="controls-panel">
            
            <div class="top-row">
                <div class="balance-box">
                    <span id="balance">50000</span>
                </div>
                <input type="number" class="input-box" id="betAmount" value="100">
            </div>

            <div class="mines-select">
                <button class="mine-btn active" onclick="setMines(1, this)">1</button>
                <button class="mine-btn" onclick="setMines(3, this)">3</button>
                <button class="mine-btn" onclick="setMines(5, this)">5</button>
                <button class="mine-btn" onclick="setMines(10, this)">10</button>
            </div>

            <button class="action-btn" id="mainBtn" onclick="startGame()">START</button>
        </div>

    </div>

    <script>
        // --- LOADING LOGIC ---
        window.onload = function() {
            const bar = document.getElementById('progressBar');
            const loader = document.getElementById('loader');
            const game = document.getElementById('gameScreen');
            let width = 0;

            const simulateLoading = () => {
                let jump = Math.floor(Math.random() * 15) + 1; 
                if(Math.random() > 0.7) jump = 0;
                width += jump; if(width > 100) width = 100;
                bar.style.width = width + '%';

                if (width >= 100) {
                    setTimeout(() => {
                        loader.style.opacity = '0';
                        setTimeout(() => {
                            loader.style.display = 'none';
                            game.classList.add('active');
                        }, 800);
                    }, 500);
                } else {
                    setTimeout(simulateLoading, Math.random() * 100 + 50);
                }
            };
            simulateLoading();
            createGrid();
        };

        // --- GAME LOGIC ---
        let balance = 50000;
        let isPlaying = false;
        let mineCount = 1;
        let minesLocation = [];
        let currentBet = 0;
        let currentMultiplier = 1.0;

        function createGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.id = `tile-${i}`;
                tile.onclick = () => clickTile(i);
                grid.appendChild(tile);
            }
        }

        function setMines(num, btn) {
            if(isPlaying) return;
            mineCount = num;
            document.querySelectorAll('.mine-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function startGame() {
            if(isPlaying) {
                cashOut();
                return;
            }

            const betInput = document.getElementById('betAmount');
            const bet = parseInt(betInput.value);

            if(bet > balance) { alert("Insufficient Balance"); return; }
            if(bet < 10) { alert("Min Bet 10"); return; }

            balance -= bet;
            currentBet = bet;
            updateUI();

            isPlaying = true;
            currentMultiplier = 1.0;
            minesLocation = generateMines();
            
            // Reset Grid Images
            document.querySelectorAll('.tile').forEach(t => {
                t.className = 'tile'; // Reset classes
            });
            document.getElementById('msgBox').style.transform = "translate(-50%, -50%) scale(0)";

            const btn = document.getElementById('mainBtn');
            btn.innerText = "CASHOUT";
        }

        function generateMines() {
            let locs = [];
            while(locs.length < mineCount) {
                let r = Math.floor(Math.random() * 25);
                if(!locs.includes(r)) locs.push(r);
            }
            return locs;
        }

        function clickTile(index) {
            if(!isPlaying) return;
            const tile = document.getElementById(`tile-${index}`);
            
            // Check if already opened (has class diamond or bomb)
            if(tile.classList.contains('diamond') || tile.classList.contains('bomb')) return;

            if(minesLocation.includes(index)) {
                // GAME OVER
                gameOver(index);
            } else {
                // DIAMOND FOUND
                tile.classList.add('diamond'); // This sets bg image to tile_diamond.png
                
                // Increase Multiplier logic
                currentMultiplier += (0.1 * mineCount);
                let winVal = Math.floor(currentBet * currentMultiplier);
                document.getElementById('mainBtn').innerText = "CLAIM " + winVal;
            }
        }

        function cashOut() {
            if(!isPlaying) return;
            let winVal = Math.floor(currentBet * currentMultiplier);
            balance += winVal;
            updateUI();
            
            showPopup("YOU WON", "+" + winVal, "#00ff00");
            endGame();
        }

        function gameOver(hitIndex) {
            // Reveal Hit Mine
            document.getElementById(`tile-${hitIndex}`).classList.add('bomb');

            // Reveal All Mines
            minesLocation.forEach(idx => {
                document.getElementById(`tile-${idx}`).classList.add('bomb');
            });

            // Dim others
            document.querySelectorAll('.tile:not(.bomb):not(.diamond)').forEach(t => t.classList.add('dim'));

            showPopup("GAME OVER", "TRY AGAIN", "red");
            endGame();
        }

        function endGame() {
            isPlaying = false;
            document.getElementById('mainBtn').innerText = "START";
        }

        function showPopup(title, val, color) {
            const box = document.getElementById('msgBox');
            document.getElementById('msgTitle').innerText = title;
            document.getElementById('msgVal').innerText = val;
            document.getElementById('msgVal').style.color = color;
            box.style.transform = "translate(-50%, -50%) scale(1)";
            setTimeout(() => {
                if(!isPlaying) box.style.transform = "translate(-50%, -50%) scale(0)";
            }, 2000);
        }

        function updateUI() {
            document.getElementById('balance').innerText = balance;
        }

    </script>
</body>
</html>
